create env spark(
    spark.default.parallelism='2',
    spark.sql.shuffle.partitions='2'
)WITH(
    appname='WooTest'
);

CREATE TABLE InputTable(
    number Int
)WITH(
    type='socket',
    host='localhost',
    processwindow='10 seconds,5 seconds',
    port='9998'
);

CREATE SINK OutputTable(
)WITH(
    type='console',
    outputmode='update',
    trigger='2 seconds'
);

insert into OutputTable select processwindow,number,count(*) from InputTable group by processwindow,number;
