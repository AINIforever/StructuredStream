create env spark(
    spark.default.parallelism='2',
    spark.sql.shuffle.partitions='2'
)WITH(
    appname='WooTest'
);

CREATE TABLE InputTable(
    id int,
    name string
)WITH(
    type='socket',
    host='localhost',
    processwindow='10 seconds,10 seconds',
    watermark='30 seconds',
    port='9999'
);

CREATE TABLE InputTable2(
    id int,
    name string
)WITH(
    type='socket',
    host='localhost',
    processwindow='10 seconds,10 seconds',
    watermark='30 seconds',
    port='9999'
);

CREATE TABLE RandomIntTable(
    number String
)WITH(
    type='socket',
    host='localhost',
    processwindow='10 milliseconds,10 milliseconds',
    port='9999'
);

CREATE TABLE ImageTable(
    image string
)WITH(
    type='socket',
    host='localhost',
    port='9998'
);

CREATE SINK OutputTable(
)WITH(
    type='console',
    outputmode='update'
);


CREATE SINK ImageOutputTable(
)WITH(
    type='image',
    outputmode='append'
);

CREATE SINK ImageOutputTable2(
)WITH(
    type='image',
    outputmode='append',
    continuetrigger='2 seconds'
);

insert into OutputTable select number,processwindow from RandomIntTable group by number,processwindow;
